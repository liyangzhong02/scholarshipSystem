{"ast":null,"code":"import request from \"@/utils/request\";\nimport moment from 'moment';\nexport default {\n  name: 'student',\n  components: {},\n  data() {\n    return {\n      dialogVisible: false,\n      form: {},\n      search: \"\",\n      tableData: [],\n      currentPage: 1,\n      pageSize: 10,\n      total: 0\n    };\n  },\n  created() {\n    //開始時調用，鈎子函數\n    this.load();\n  },\n  methods: {\n    add() {\n      this.dialogVisible = true;\n      this.form = {};\n      this.load();\n    },\n    save() {\n      //\n      if (this.form.id) {\n        //form里有id就执行更新\n        const userInfo = sessionStorage.getItem('student');\n        const operator = userInfo ? JSON.parse(userInfo).sname : null;\n        console.log(operator); // 确保获取到了正确的用户名\n        this.form.operator = operator;\n        const currentTime = new Date();\n        this.form.operator = operator;\n        this.form.operatetime = currentTime;\n        request.put(\"/student\", this.form).then(res => {\n          console.log(res);\n          if (res.code === '0') {\n            this.$message({\n              type: \"success\",\n              message: \"更新成功\"\n            });\n          } else {\n            this.$message({\n              type: \"error\",\n              message: \"更新失败\"\n            });\n          }\n        });\n      } else {\n        const userInfo = sessionStorage.getItem('student');\n        const operator = userInfo ? JSON.parse(userInfo).sname : null;\n        console.log(operator); // 确保获取到了正确的用户名\n        this.form.operator = operator;\n        const currentTime = new Date();\n        this.form.operator = operator;\n        this.form.operatetime = currentTime;\n        request.post(\"/student\", this.form).then(res => {\n          console.log(res);\n          if (res.code === '0') {\n            this.$message({\n              type: \"success\",\n              message: \"增加成功\"\n            });\n          } else {\n            this.$message({\n              type: \"error\",\n              message: \"增加失败\"\n            });\n          }\n        });\n      }\n    },\n    load() {\n      request.get(\"/student\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize,\n          search: this.search\n        }\n      }).then(res => {\n        console.log(res);\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n    handleEdit(row) {\n      this.form = JSON.parse(JSON.stringify(row)); //深拷贝\n      this.dialogVisible = true;\n    },\n    handleDelete(id) {\n      console.log(id);\n      //下面request的url中参数的id就会通过UserController中的@PathVariable传入”/{id}“占位符中\n      request.delete(\"/student/\" + id).then(res => {\n        if (res.code === '0') {\n          this.$message({\n            type: \"success\",\n            message: \"删除成功\"\n          });\n        } else {\n          this.$message({\n            type: \"error\",\n            message: \"删除失败\"\n          });\n        }\n        this.load(); //重载表格\n      });\n    },\n\n    handleSizeChange() {\n      this.load(); //重载表格\n    },\n\n    handleCurrentChange() {\n      this.load(); //重载表格\n    }\n  }\n};","map":{"version":3,"names":["request","moment","name","components","data","dialogVisible","form","search","tableData","currentPage","pageSize","total","created","load","methods","add","save","id","userInfo","sessionStorage","getItem","operator","JSON","parse","sname","console","log","currentTime","Date","operatetime","put","then","res","code","$message","type","message","post","get","params","pageNum","records","handleEdit","row","stringify","handleDelete","delete","handleSizeChange","handleCurrentChange"],"sources":["E:\\Documents\\Code\\Java\\2023database-master\\vue3\\vue\\src\\views\\Student.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin: auto\">\n      <el-input v-model=\"search\" placeholder=\"请输入需要搜索的学号\" style=\"width: 10%; margin: auto\" clearable/>\n      <el-button type=\"primary\" style=\"margin: auto\" @click=\"load\">搜索</el-button>\n    </div>\n    <div class=\"home\" style=\"display: flex; padding: 10px\">\n<!--      无敌filter    -->\n      <el-table :data=\"tableData.filter((v) => v.sno !== 1 && v.deleted !== 1)\" style=\"width: 100%\" >\n        <el-table-column prop=\"sno\" label=\"学号\" />\n        <el-table-column prop=\"syear\" label=\"年份\" />\n        <el-table-column prop=\"sname\" label=\"姓名\"/>\n        <el-table-column prop=\"sgrade\" label=\"年级\"/>\n        <el-table-column prop=\"stotal\" label=\"综合成绩\"/>\n        <el-table-column prop=\"isprice\" label=\"获得奖项\"/>\n        <el-table-column prop=\"sinfo\" label=\"个人信息\"/>\n        <el-table-column fixed=\"right\" label=\"操作\">\n          <template #default=\"scope\">\n            <el-button link type=\"primary\" size=\"small\" @click=\"handleEdit(scope.row)\">编辑</el-button>\n            <el-popconfirm title=\"确定要删除吗?\" @confirm=\"handleDelete(scope.row.id)\">\n              <template #reference>\n                <el-button link type=\"primary\" size=\"small\">删除</el-button>\n              </template>\n            </el-popconfirm>\n          </template>\n        </el-table-column>\n      </el-table>\n\n\n    </div>\n    <div style=\"margin: 10px; padding: 10px; margin: auto\">\n      <el-button type=\"primary\" style=\"margin: 10px; margin: auto\" @click=\"add\">新增</el-button>\n    </div>\n\n    <div class=\"demo-pagination-block\">\n      <div class=\"demonstration\"></div>\n      <el-pagination\n          v-model:current-page=\"currentPage\"\n          v-model:page-size=\"pageSize\"\n          :page-sizes=\"pageSize\"\n          :small=\"small\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=total\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n      />\n    </div>\n\n    <el-dialog\n        v-model=\"dialogVisible\" title=\"\" width=\"30%\">\n      <el-form :model=\"form\" label-width=\"120px\">\n        <el-form-item label=\"学号\">\n          <el-input v-model=\"form.sno\" style=\"width: 80%; height: 80%\" ></el-input>\n        </el-form-item>\n        <el-form-item label=\"年份\">\n          <el-input v-model=\"form.syear\" style=\"width: 80%; height: 80%\" ></el-input>\n        </el-form-item>\n        <el-form-item label=\"名称\">\n          <el-input v-model=\"form.sname\" style=\"width: 80%; height: 80%\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"年级\">\n          <el-input v-model=\"form.sgrade\" style=\"width: 80%; height: 80%\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"综合成绩\">\n          <el-input v-model=\"form.stotal\" style=\"width: 80%; height: 80%\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"获得奖项\">\n          <div class=\"mb-2 flex items-center text-sm\">\n            <el-radio v-model=\"form.isprice\" label=\"无\" size=\"large\">无</el-radio>\n            <el-radio v-model=\"form.isprice\" label=\"国家级奖学金\" size=\"large\">国家级奖学金</el-radio>\n            </div>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"save\">确定</el-button>\n      </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n\n\n\n<script>\n\n\nimport request from \"@/utils/request\";\nimport moment from 'moment';\n\nexport default {\n  name: 'student',\n  components: {},\n  data() {\n    return {\n      dialogVisible: false,\n      form: {},\n      search: \"\",\n      tableData: [],\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n    }\n  },\n  created(){ //開始時調用，鈎子函數\n    this.load()\n  },\n  methods: {\n    add(){\n      this.dialogVisible = true\n      this.form = {}\n      this.load()\n    },\n\n    save() { //\n      if (this.form.id) {//form里有id就执行更新\n        const userInfo = sessionStorage.getItem('student');\n        const operator = userInfo ? JSON.parse(userInfo).sname : null;\n        console.log(operator); // 确保获取到了正确的用户名\n        this.form.operator = operator;\n        const currentTime = new Date();\n\n        this.form.operator = operator;\n        this.form.operatetime = currentTime;\n\n        request.put(\"/student\", this.form).then(res => {\n          console.log(res)\n          if (res.code === '0') {\n            this.$message({type: \"success\", message: \"更新成功\"})\n          } else {\n            this.$message({type: \"error\", message: \"更新失败\"})\n          }\n        })\n      } else {\n        const userInfo = sessionStorage.getItem('student');\n        const operator = userInfo ? JSON.parse(userInfo).sname : null;\n        console.log(operator); // 确保获取到了正确的用户名\n        this.form.operator = operator;\n        const currentTime = new Date();\n\n        this.form.operator = operator;\n        this.form.operatetime = currentTime;\n\n        request.post(\"/student\", this.form).then(res => {\n          console.log(res)\n          if (res.code === '0') {\n            this.$message({type: \"success\", message: \"增加成功\"})\n          } else {\n            this.$message({type: \"error\", message: \"增加失败\"})\n          }\n        })\n      }\n    },\n\n    load(){\n      request.get(\"/student\",{\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize,\n          search: this.search\n        }\n      }).then(res =>{console.log(res)\n      this.tableData = res.data.records\n      this.total = res.data.total\n      })\n    },\n\n    handleEdit(row){\n      this.form = JSON.parse(JSON.stringify(row)) //深拷贝\n      this.dialogVisible = true\n    },\n\n    handleDelete(id){\n      console.log(id)\n      //下面request的url中参数的id就会通过UserController中的@PathVariable传入”/{id}“占位符中\n      request.delete(\"/student/\" + id).then(res => {\n        if(res.code === '0'){\n          this.$message({type: \"success\", message:\"删除成功\"})\n        }\n        else {\n          this.$message({type: \"error\", message:\"删除失败\"})\n        }\n        this.load() //重载表格\n      })\n    },\n\n    handleSizeChange(){\n      this.load() //重载表格\n    },\n    handleCurrentChange(){\n      this.load() //重载表格\n    },\n\n  }\n}\n\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}